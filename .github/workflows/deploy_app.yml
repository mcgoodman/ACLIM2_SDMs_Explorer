name: Deploy Shiny App

on:
  push:

jobs:  
  deploy_app: 
    runs-on: ubuntu-latest
    steps:  
    - name: Check out repository  
      uses: actions/checkout@v5  

    - name: Install R
      uses: r-lib/actions/setup-r@v2  
    
    - name: Install R packages
      uses: r-lib/actions/setup-r-dependencies@v2
      with:
        cache: always
      
    - name: Deploy app
      env: 
        NMFS_API_KEY: ${{ secrets.NMFS_API_KEY }}
        SHINYAPPSIO_API_TOKEN: ${{ secrets.SHINYAPPSIO_API_TOKEN }}
        SHINYAPPSIO_API_SECRET: ${{ secrets.SHINYAPPSIO_API_SECRET }}
      shell: Rscript {0}
      run: source("deploy.R")
